{"ast":null,"code":"import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport { proFieldParsingValueEnumToArray } from '@ant-design/pro-field';\nimport { omitBoolean, omitUndefinedAndEmptyArr, runFunction } from '@ant-design/pro-utils';\nimport { Table } from 'antd';\nimport { columnRender, defaultOnFilter, renderColumnsTitle } from \"./columnRender\";\nimport { genColumnKey } from \"./index\";\n/**\n * 转化 columns 到 pro 的格式 主要是 render 方法的自行实现\n *\n * @param columns\n * @param map\n * @param columnEmptyText\n */\nexport function genProColumnToColumn(params, parents) {\n  var _columns$map;\n  var columns = params.columns,\n    counter = params.counter,\n    columnEmptyText = params.columnEmptyText,\n    type = params.type,\n    editableUtils = params.editableUtils,\n    _params$rowKey = params.rowKey,\n    rowKey = _params$rowKey === void 0 ? 'id' : _params$rowKey,\n    _params$childrenColum = params.childrenColumnName,\n    childrenColumnName = _params$childrenColum === void 0 ? 'children' : _params$childrenColum;\n  var subNameRecord = new Map();\n  return columns === null || columns === void 0 ? void 0 : (_columns$map = columns.map(function (columnProps, columnsIndex) {\n    var _ref = columnProps,\n      key = _ref.key,\n      dataIndex = _ref.dataIndex,\n      valueEnum = _ref.valueEnum,\n      _ref$valueType = _ref.valueType,\n      valueType = _ref$valueType === void 0 ? 'text' : _ref$valueType,\n      children = _ref.children,\n      onFilter = _ref.onFilter,\n      _ref$filters = _ref.filters,\n      filters = _ref$filters === void 0 ? [] : _ref$filters;\n    var columnKey = genColumnKey(key || (dataIndex === null || dataIndex === void 0 ? void 0 : dataIndex.toString()), [parents === null || parents === void 0 ? void 0 : parents.key, columnsIndex].filter(Boolean).join('-'));\n    // 这些都没有，说明是普通的表格不需要 pro 管理\n    var noNeedPro = !valueEnum && !valueType && !children;\n    if (noNeedPro) {\n      return _objectSpread({\n        index: columnsIndex\n      }, columnProps);\n    }\n\n    /**\n     * 是不是展开行和多选按钮\n     */\n    var isExtraColumns = columnProps === Table.EXPAND_COLUMN || columnProps === Table.SELECTION_COLUMN;\n    if (isExtraColumns) {\n      return {\n        index: columnsIndex,\n        isExtraColumns: true,\n        hideInSearch: true,\n        hideInTable: false,\n        hideInForm: true,\n        hideInSetting: true,\n        extraColumn: columnProps\n      };\n    }\n    var config = counter.columnsMap[columnKey] || {\n      fixed: columnProps.fixed\n    };\n    var genOnFilter = function genOnFilter() {\n      if (onFilter === true) {\n        return function (value, row) {\n          return defaultOnFilter(value, row, dataIndex);\n        };\n      }\n      return omitBoolean(onFilter);\n    };\n    var keyName = rowKey;\n    var tempColumns = _objectSpread(_objectSpread({\n      index: columnsIndex,\n      key: columnKey\n    }, columnProps), {}, {\n      title: renderColumnsTitle(columnProps),\n      valueEnum: valueEnum,\n      filters: filters === true ? proFieldParsingValueEnumToArray(runFunction(valueEnum, undefined)).filter(function (valueItem) {\n        return valueItem && valueItem.value !== 'all';\n      }) : filters,\n      onFilter: genOnFilter(),\n      fixed: config.fixed,\n      width: columnProps.width || (columnProps.fixed ? 200 : undefined),\n      children: columnProps.children ? genProColumnToColumn(_objectSpread(_objectSpread({}, params), {}, {\n        columns: columnProps === null || columnProps === void 0 ? void 0 : columnProps.children\n      }), _objectSpread(_objectSpread({}, columnProps), {}, {\n        key: columnKey\n      })) : undefined,\n      render: function render(text, rowData, index) {\n        if (typeof rowKey === 'function') {\n          keyName = rowKey(rowData, index);\n        }\n        var uniqueKey;\n        if (Reflect.has(rowData, keyName)) {\n          var _rowData$childrenColu;\n          uniqueKey = rowData[keyName];\n          var parentInfo = subNameRecord.get(uniqueKey) || [];\n          (_rowData$childrenColu = rowData[childrenColumnName]) === null || _rowData$childrenColu === void 0 ? void 0 : _rowData$childrenColu.forEach(function (item) {\n            var itemUniqueKey = item[keyName];\n            if (!subNameRecord.has(itemUniqueKey)) {\n              subNameRecord.set(itemUniqueKey, parentInfo.concat([index, childrenColumnName]));\n            }\n          });\n        }\n        var renderProps = {\n          columnProps: columnProps,\n          text: text,\n          rowData: rowData,\n          index: index,\n          columnEmptyText: columnEmptyText,\n          counter: counter,\n          type: type,\n          subName: subNameRecord.get(uniqueKey),\n          editableUtils: editableUtils\n        };\n        return columnRender(renderProps);\n      }\n    });\n    return omitUndefinedAndEmptyArr(tempColumns);\n  })) === null || _columns$map === void 0 ? void 0 : _columns$map.filter(function (item) {\n    return !item.hideInTable;\n  });\n}","map":{"version":3,"names":["_objectSpread","proFieldParsingValueEnumToArray","omitBoolean","omitUndefinedAndEmptyArr","runFunction","Table","columnRender","defaultOnFilter","renderColumnsTitle","genColumnKey","genProColumnToColumn","params","parents","_columns$map","columns","counter","columnEmptyText","type","editableUtils","_params$rowKey","rowKey","_params$childrenColum","childrenColumnName","subNameRecord","Map","map","columnProps","columnsIndex","_ref","key","dataIndex","valueEnum","_ref$valueType","valueType","children","onFilter","_ref$filters","filters","columnKey","toString","filter","Boolean","join","noNeedPro","index","isExtraColumns","EXPAND_COLUMN","SELECTION_COLUMN","hideInSearch","hideInTable","hideInForm","hideInSetting","extraColumn","config","columnsMap","fixed","genOnFilter","value","row","keyName","tempColumns","title","undefined","valueItem","width","render","text","rowData","uniqueKey","Reflect","has","_rowData$childrenColu","parentInfo","get","forEach","item","itemUniqueKey","set","concat","renderProps","subName"],"sources":["D:/LearnDeveloper/ReactJS/student-management-infor/node_modules/@ant-design/pro-table/es/utils/genProColumnToColumn.js"],"sourcesContent":["import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport { proFieldParsingValueEnumToArray } from '@ant-design/pro-field';\nimport { omitBoolean, omitUndefinedAndEmptyArr, runFunction } from '@ant-design/pro-utils';\nimport { Table } from 'antd';\nimport { columnRender, defaultOnFilter, renderColumnsTitle } from \"./columnRender\";\nimport { genColumnKey } from \"./index\";\n/**\n * 转化 columns 到 pro 的格式 主要是 render 方法的自行实现\n *\n * @param columns\n * @param map\n * @param columnEmptyText\n */\nexport function genProColumnToColumn(params, parents) {\n  var _columns$map;\n  var columns = params.columns,\n    counter = params.counter,\n    columnEmptyText = params.columnEmptyText,\n    type = params.type,\n    editableUtils = params.editableUtils,\n    _params$rowKey = params.rowKey,\n    rowKey = _params$rowKey === void 0 ? 'id' : _params$rowKey,\n    _params$childrenColum = params.childrenColumnName,\n    childrenColumnName = _params$childrenColum === void 0 ? 'children' : _params$childrenColum;\n  var subNameRecord = new Map();\n  return columns === null || columns === void 0 ? void 0 : (_columns$map = columns.map(function (columnProps, columnsIndex) {\n    var _ref = columnProps,\n      key = _ref.key,\n      dataIndex = _ref.dataIndex,\n      valueEnum = _ref.valueEnum,\n      _ref$valueType = _ref.valueType,\n      valueType = _ref$valueType === void 0 ? 'text' : _ref$valueType,\n      children = _ref.children,\n      onFilter = _ref.onFilter,\n      _ref$filters = _ref.filters,\n      filters = _ref$filters === void 0 ? [] : _ref$filters;\n    var columnKey = genColumnKey(key || (dataIndex === null || dataIndex === void 0 ? void 0 : dataIndex.toString()), [parents === null || parents === void 0 ? void 0 : parents.key, columnsIndex].filter(Boolean).join('-'));\n    // 这些都没有，说明是普通的表格不需要 pro 管理\n    var noNeedPro = !valueEnum && !valueType && !children;\n    if (noNeedPro) {\n      return _objectSpread({\n        index: columnsIndex\n      }, columnProps);\n    }\n\n    /**\n     * 是不是展开行和多选按钮\n     */\n    var isExtraColumns = columnProps === Table.EXPAND_COLUMN || columnProps === Table.SELECTION_COLUMN;\n    if (isExtraColumns) {\n      return {\n        index: columnsIndex,\n        isExtraColumns: true,\n        hideInSearch: true,\n        hideInTable: false,\n        hideInForm: true,\n        hideInSetting: true,\n        extraColumn: columnProps\n      };\n    }\n    var config = counter.columnsMap[columnKey] || {\n      fixed: columnProps.fixed\n    };\n    var genOnFilter = function genOnFilter() {\n      if (onFilter === true) {\n        return function (value, row) {\n          return defaultOnFilter(value, row, dataIndex);\n        };\n      }\n      return omitBoolean(onFilter);\n    };\n    var keyName = rowKey;\n    var tempColumns = _objectSpread(_objectSpread({\n      index: columnsIndex,\n      key: columnKey\n    }, columnProps), {}, {\n      title: renderColumnsTitle(columnProps),\n      valueEnum: valueEnum,\n      filters: filters === true ? proFieldParsingValueEnumToArray(runFunction(valueEnum, undefined)).filter(function (valueItem) {\n        return valueItem && valueItem.value !== 'all';\n      }) : filters,\n      onFilter: genOnFilter(),\n      fixed: config.fixed,\n      width: columnProps.width || (columnProps.fixed ? 200 : undefined),\n      children: columnProps.children ? genProColumnToColumn(_objectSpread(_objectSpread({}, params), {}, {\n        columns: columnProps === null || columnProps === void 0 ? void 0 : columnProps.children\n      }), _objectSpread(_objectSpread({}, columnProps), {}, {\n        key: columnKey\n      })) : undefined,\n      render: function render(text, rowData, index) {\n        if (typeof rowKey === 'function') {\n          keyName = rowKey(rowData, index);\n        }\n        var uniqueKey;\n        if (Reflect.has(rowData, keyName)) {\n          var _rowData$childrenColu;\n          uniqueKey = rowData[keyName];\n          var parentInfo = subNameRecord.get(uniqueKey) || [];\n          (_rowData$childrenColu = rowData[childrenColumnName]) === null || _rowData$childrenColu === void 0 ? void 0 : _rowData$childrenColu.forEach(function (item) {\n            var itemUniqueKey = item[keyName];\n            if (!subNameRecord.has(itemUniqueKey)) {\n              subNameRecord.set(itemUniqueKey, parentInfo.concat([index, childrenColumnName]));\n            }\n          });\n        }\n        var renderProps = {\n          columnProps: columnProps,\n          text: text,\n          rowData: rowData,\n          index: index,\n          columnEmptyText: columnEmptyText,\n          counter: counter,\n          type: type,\n          subName: subNameRecord.get(uniqueKey),\n          editableUtils: editableUtils\n        };\n        return columnRender(renderProps);\n      }\n    });\n    return omitUndefinedAndEmptyArr(tempColumns);\n  })) === null || _columns$map === void 0 ? void 0 : _columns$map.filter(function (item) {\n    return !item.hideInTable;\n  });\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}