{"ast":null,"code":"//@ts-ignore\nimport { pathToRegexp } from '../path-to-regexp';\nimport getFlatMenu from '../getFlatMenus/getFlatMenus';\nimport { isUrl, stripQueryStringAndHashFromPath } from '../transformRoute/transformRoute';\nexport var getMenuMatches = function getMenuMatches() {\n  var flatMenuKeys = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var path = arguments.length > 1 ? arguments[1] : undefined;\n  var exact = arguments.length > 2 ? arguments[2] : undefined;\n  return flatMenuKeys.filter(function (item) {\n    if (item === '/' && path === '/') {\n      return true;\n    }\n    if (item !== '/' && item !== '/*' && item && !isUrl(item)) {\n      var pathKey = stripQueryStringAndHashFromPath(item);\n      try {\n        // exact\n        if (exact) {\n          if (pathToRegexp(\"\".concat(pathKey)).test(path)) {\n            return true;\n          }\n        } // /a\n\n        if (pathToRegexp(\"\".concat(pathKey), []).test(path)) {\n          return true;\n        } // /a/b/b\n\n        if (pathToRegexp(\"\".concat(pathKey, \"/(.*)\")).test(path)) {\n          return true;\n        }\n      } catch (error) {// console.log(error, path);\n      }\n    }\n    return false;\n  }).sort(function (a, b) {\n    // 如果完全匹配放到最后面\n    if (a === path) {\n      return 10;\n    }\n    if (b === path) {\n      return -10;\n    }\n    return a.substr(1).split('/').length - b.substr(1).split('/').length;\n  });\n};\n/**\n * 获取当前的选中菜单列表\n * @param pathname\n * @param menuData\n * @returns MenuDataItem[]\n */\n\nexport var getMatchMenu = function getMatchMenu(pathname, menuData,\n/**\n * 要不要展示全部的 key\n */\nfullKeys, exact) {\n  var flatMenus = getFlatMenu(menuData);\n  var flatMenuKeys = Object.keys(flatMenus);\n  var menuPathKeys = getMenuMatches(flatMenuKeys, pathname || '/', exact);\n  if (!menuPathKeys || menuPathKeys.length < 1) {\n    return [];\n  }\n  if (!fullKeys) {\n    menuPathKeys = [menuPathKeys[menuPathKeys.length - 1]];\n  }\n  return menuPathKeys.map(function (menuPathKey) {\n    var menuItem = flatMenus[menuPathKey] || {\n      pro_layout_parentKeys: '',\n      key: ''\n    }; // 去重\n\n    var map = new Map();\n    var parentItems = (menuItem.pro_layout_parentKeys || []).map(function (key) {\n      if (map.has(key)) {\n        return null;\n      }\n      map.set(key, true);\n      return flatMenus[key];\n    }).filter(function (item) {\n      return item;\n    });\n    if (menuItem.key) {\n      parentItems.push(menuItem);\n    }\n    return parentItems;\n  }).flat(1);\n};\nexport default getMatchMenu;","map":{"version":3,"names":["pathToRegexp","getFlatMenu","isUrl","stripQueryStringAndHashFromPath","getMenuMatches","flatMenuKeys","arguments","length","undefined","path","exact","filter","item","pathKey","concat","test","error","sort","a","b","substr","split","getMatchMenu","pathname","menuData","fullKeys","flatMenus","Object","keys","menuPathKeys","map","menuPathKey","menuItem","pro_layout_parentKeys","key","Map","parentItems","has","set","push","flat"],"sources":["D:/LearnDeveloper/ReactJS/student-management-infor/node_modules/@umijs/route-utils/es/getMatchMenu/getMatchMenu.js"],"sourcesContent":["//@ts-ignore\nimport { pathToRegexp } from '../path-to-regexp';\nimport getFlatMenu from '../getFlatMenus/getFlatMenus';\nimport { isUrl, stripQueryStringAndHashFromPath } from '../transformRoute/transformRoute';\nexport var getMenuMatches = function getMenuMatches() {\n  var flatMenuKeys = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var path = arguments.length > 1 ? arguments[1] : undefined;\n  var exact = arguments.length > 2 ? arguments[2] : undefined;\n  return flatMenuKeys.filter(function (item) {\n    if (item === '/' && path === '/') {\n      return true;\n    }\n\n    if (item !== '/' && item !== '/*' && item && !isUrl(item)) {\n      var pathKey = stripQueryStringAndHashFromPath(item);\n\n      try {\n        // exact\n        if (exact) {\n          if (pathToRegexp(\"\".concat(pathKey)).test(path)) {\n            return true;\n          }\n        } // /a\n\n\n        if (pathToRegexp(\"\".concat(pathKey), []).test(path)) {\n          return true;\n        } // /a/b/b\n\n\n        if (pathToRegexp(\"\".concat(pathKey, \"/(.*)\")).test(path)) {\n          return true;\n        }\n      } catch (error) {// console.log(error, path);\n      }\n    }\n\n    return false;\n  }).sort(function (a, b) {\n    // 如果完全匹配放到最后面\n    if (a === path) {\n      return 10;\n    }\n\n    if (b === path) {\n      return -10;\n    }\n\n    return a.substr(1).split('/').length - b.substr(1).split('/').length;\n  });\n};\n/**\n * 获取当前的选中菜单列表\n * @param pathname\n * @param menuData\n * @returns MenuDataItem[]\n */\n\nexport var getMatchMenu = function getMatchMenu(pathname, menuData,\n/**\n * 要不要展示全部的 key\n */\nfullKeys, exact) {\n  var flatMenus = getFlatMenu(menuData);\n  var flatMenuKeys = Object.keys(flatMenus);\n  var menuPathKeys = getMenuMatches(flatMenuKeys, pathname || '/', exact);\n\n  if (!menuPathKeys || menuPathKeys.length < 1) {\n    return [];\n  }\n\n  if (!fullKeys) {\n    menuPathKeys = [menuPathKeys[menuPathKeys.length - 1]];\n  }\n\n  return menuPathKeys.map(function (menuPathKey) {\n    var menuItem = flatMenus[menuPathKey] || {\n      pro_layout_parentKeys: '',\n      key: ''\n    }; // 去重\n\n    var map = new Map();\n    var parentItems = (menuItem.pro_layout_parentKeys || []).map(function (key) {\n      if (map.has(key)) {\n        return null;\n      }\n\n      map.set(key, true);\n      return flatMenus[key];\n    }).filter(function (item) {\n      return item;\n    });\n\n    if (menuItem.key) {\n      parentItems.push(menuItem);\n    }\n\n    return parentItems;\n  }).flat(1);\n};\nexport default getMatchMenu;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}