{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"@babel/runtime/helpers/esm/regeneratorRuntime\";\nimport _toArray from \"@babel/runtime/helpers/esm/toArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\nvar _excluded = [\"map_row_parentKey\"],\n  _excluded2 = [\"map_row_parentKey\", \"map_row_key\"],\n  _excluded3 = [\"map_row_key\"];\n/* eslint-disable react-hooks/exhaustive-deps */\nimport { LoadingOutlined } from '@ant-design/icons';\nimport { useIntl } from '@ant-design/pro-provider';\nimport { Form, message, Popconfirm } from 'antd';\nimport useLazyKVMap from \"antd/es/table/hooks/useLazyKVMap\";\nimport useMergedState from \"rc-util/es/hooks/useMergedState\";\nimport get from \"rc-util/es/utils/get\";\nimport set from \"rc-util/es/utils/set\";\nimport { noteOnce } from \"rc-util/es/warning\";\nimport React, { createRef, forwardRef, useContext, useEffect, useImperativeHandle, useMemo, useRef, useState } from 'react';\nimport { useDebounceFn, useRefFunction } from '..';\nimport { ProFormContext } from \"../components/ProFormContext\";\nimport { useDeepCompareEffectDebounce } from \"../hooks/useDeepCompareEffect\";\nimport { usePrevious } from \"../hooks/usePrevious\";\nimport { merge } from \"../merge\";\nimport { useMountMergeState } from \"../useMountMergeState\";\n\n/**\n * 兼容antd@4 和 antd@5 的warning\n * @param messageStr\n */\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar warning = function warning(messageStr) {\n  // @ts-ignore\n  return (message.warn || message.warning)(messageStr);\n};\nexport var recordKeyToString = function recordKeyToString(rowKey) {\n  if (Array.isArray(rowKey)) return rowKey.join(',');\n  return rowKey;\n};\n/**\n * 使用map 来删除数据，性能一般 但是准确率比较高\n *\n * @param keyProps\n * @param action\n */\nexport function editableRowByKey(keyProps, action) {\n  var _recordKeyToString;\n  var getRowKey = keyProps.getRowKey,\n    row = keyProps.row,\n    data = keyProps.data,\n    _keyProps$childrenCol = keyProps.childrenColumnName,\n    childrenColumnName = _keyProps$childrenCol === void 0 ? 'children' : _keyProps$childrenCol;\n  var key = (_recordKeyToString = recordKeyToString(keyProps.key)) === null || _recordKeyToString === void 0 ? void 0 : _recordKeyToString.toString();\n  var kvMap = new Map();\n\n  /**\n   * 打平这个数组\n   *\n   * @param records\n   * @param parentKey\n   */\n  function dig(records, map_row_parentKey, map_row_index) {\n    records.forEach(function (record, index) {\n      var eachIndex = (map_row_index || 0) * 10 + index;\n      var recordKey = getRowKey(record, eachIndex).toString();\n      // children 取在前面方便拼的时候按照反顺序放回去\n      if (record && _typeof(record) === 'object' && childrenColumnName in record) {\n        dig(record[childrenColumnName] || [], recordKey, eachIndex);\n      }\n      var newRecord = _objectSpread(_objectSpread({}, record), {}, {\n        map_row_key: recordKey,\n        children: undefined,\n        map_row_parentKey: map_row_parentKey\n      });\n      delete newRecord.children;\n      if (!map_row_parentKey) {\n        delete newRecord.map_row_parentKey;\n      }\n      kvMap.set(recordKey, newRecord);\n    });\n  }\n  if (action === 'top') {\n    kvMap.set(key, _objectSpread(_objectSpread({}, kvMap.get(key)), row));\n  }\n  dig(data);\n  if (action === 'update') {\n    kvMap.set(key, _objectSpread(_objectSpread({}, kvMap.get(key)), row));\n  }\n  if (action === 'delete') {\n    kvMap.delete(key);\n  }\n  var fill = function fill(map) {\n    var kvArrayMap = new Map();\n    var kvSource = [];\n    var fillNewRecord = function fillNewRecord() {\n      var fillChildren = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      map.forEach(function (value) {\n        if (value.map_row_parentKey && !value.map_row_key) {\n          var map_row_parentKey = value.map_row_parentKey,\n            rest = _objectWithoutProperties(value, _excluded);\n          if (!kvArrayMap.has(map_row_parentKey)) {\n            kvArrayMap.set(map_row_parentKey, []);\n          }\n          if (fillChildren) {\n            var _kvArrayMap$get;\n            (_kvArrayMap$get = kvArrayMap.get(map_row_parentKey)) === null || _kvArrayMap$get === void 0 ? void 0 : _kvArrayMap$get.push(rest);\n          }\n        }\n      });\n    };\n    fillNewRecord(action === 'top');\n    map.forEach(function (value) {\n      if (value.map_row_parentKey && value.map_row_key) {\n        var _kvArrayMap$get2;\n        var map_row_parentKey = value.map_row_parentKey,\n          map_row_key = value.map_row_key,\n          rest = _objectWithoutProperties(value, _excluded2);\n        if (kvArrayMap.has(map_row_key)) {\n          rest[childrenColumnName] = kvArrayMap.get(map_row_key);\n        }\n        if (!kvArrayMap.has(map_row_parentKey)) {\n          kvArrayMap.set(map_row_parentKey, []);\n        }\n        (_kvArrayMap$get2 = kvArrayMap.get(map_row_parentKey)) === null || _kvArrayMap$get2 === void 0 ? void 0 : _kvArrayMap$get2.push(rest);\n      }\n    });\n    fillNewRecord(action === 'update');\n    map.forEach(function (value) {\n      if (!value.map_row_parentKey) {\n        var map_row_key = value.map_row_key,\n          rest = _objectWithoutProperties(value, _excluded3);\n        if (map_row_key && kvArrayMap.has(map_row_key)) {\n          var item = _objectSpread(_objectSpread({}, rest), {}, _defineProperty({}, childrenColumnName, kvArrayMap.get(map_row_key)));\n          kvSource.push(item);\n          return;\n        }\n        kvSource.push(rest);\n      }\n    });\n    return kvSource;\n  };\n  return fill(kvMap);\n}\n\n/**\n * 保存按钮的dom\n *\n * @param ActionRenderConfig\n */\nexport function SaveEditableAction(_ref, ref) {\n  var recordKey = _ref.recordKey,\n    onSave = _ref.onSave,\n    row = _ref.row,\n    children = _ref.children,\n    newLineConfig = _ref.newLineConfig,\n    editorType = _ref.editorType,\n    tableName = _ref.tableName;\n  var context = useContext(ProFormContext);\n  var form = Form.useFormInstance();\n  var _useMountMergeState = useMountMergeState(false),\n    _useMountMergeState2 = _slicedToArray(_useMountMergeState, 2),\n    loading = _useMountMergeState2[0],\n    setLoading = _useMountMergeState2[1];\n  var save = useRefFunction( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n    var _context$getFieldForm, isMapEditor, namePath, fields, _recordKey, recordKeyPath, curValue, data, res;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          _context.prev = 0;\n          isMapEditor = editorType === 'Map'; // 为了兼容类型为 array 的 dataIndex,当 recordKey 是一个数组时，用于获取表单值的 key 只取第一项，\n          // 从表单中获取回来之后，再根据 namepath 获取具体的某个字段并设置\n          namePath = [tableName, Array.isArray(recordKey) ? recordKey[0] : recordKey].map(function (key) {\n            return key === null || key === void 0 ? void 0 : key.toString();\n          }).flat(1).filter(Boolean);\n          setLoading(true);\n          // @ts-expect-error\n          _context.next = 6;\n          return form.validateFields(namePath, {\n            recursive: true\n          });\n        case 6:\n          fields = ((_context$getFieldForm = context.getFieldFormatValue) === null || _context$getFieldForm === void 0 ? void 0 : _context$getFieldForm.call(context, namePath)) || form.getFieldValue(namePath); // 处理 dataIndex 为数组的情况\n          if (Array.isArray(recordKey) && recordKey.length > 1) {\n            // 获取 namepath\n            _recordKey = _toArray(recordKey), recordKeyPath = _recordKey.slice(1); // 将目标值获取出来并设置到 fields 当中\n            curValue = get(fields, recordKeyPath);\n            set(fields, recordKeyPath, curValue);\n          }\n          data = isMapEditor ? set({}, namePath, fields, true) : fields; // 获取数据并保存\n          _context.next = 11;\n          return onSave === null || onSave === void 0 ? void 0 : onSave(recordKey,\n          // 如果是 map 模式，fields 就是一个值，所以需要set 到对象中\n          // 数据模式 fields 是一个对象，所以不需要\n          merge({}, row, data), row, newLineConfig);\n        case 11:\n          res = _context.sent;\n          setLoading(false);\n          return _context.abrupt(\"return\", res);\n        case 16:\n          _context.prev = 16;\n          _context.t0 = _context[\"catch\"](0);\n          // eslint-disable-next-line no-console\n          console.log(_context.t0);\n          setLoading(false);\n          throw _context.t0;\n        case 21:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee, null, [[0, 16]]);\n  })));\n  useImperativeHandle(ref, function () {\n    return {\n      save: save\n    };\n  });\n  return /*#__PURE__*/_jsxs(\"a\", {\n    onClick: /*#__PURE__*/function () {\n      var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e) {\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              e.stopPropagation();\n              e.preventDefault();\n              _context2.prev = 2;\n              _context2.next = 5;\n              return save();\n            case 5:\n              _context2.next = 9;\n              break;\n            case 7:\n              _context2.prev = 7;\n              _context2.t0 = _context2[\"catch\"](2);\n            case 9:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, null, [[2, 7]]);\n      }));\n      return function (_x) {\n        return _ref3.apply(this, arguments);\n      };\n    }(),\n    children: [loading ? /*#__PURE__*/_jsx(LoadingOutlined, {\n      style: {\n        marginInlineEnd: 8\n      }\n    }) : null, children || '保存']\n  }, \"save\");\n}\n/**\n * 删除按钮 dom\n *\n * @param ActionRenderConfig\n */\nexport var DeleteEditableAction = function DeleteEditableAction(_ref4) {\n  var recordKey = _ref4.recordKey,\n    onDelete = _ref4.onDelete,\n    row = _ref4.row,\n    children = _ref4.children,\n    deletePopconfirmMessage = _ref4.deletePopconfirmMessage;\n  var _useMountMergeState3 = useMountMergeState(function () {\n      return false;\n    }),\n    _useMountMergeState4 = _slicedToArray(_useMountMergeState3, 2),\n    loading = _useMountMergeState4[0],\n    setLoading = _useMountMergeState4[1];\n  var _onConfirm = useRefFunction( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n    var res;\n    return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n      while (1) switch (_context3.prev = _context3.next) {\n        case 0:\n          _context3.prev = 0;\n          setLoading(true);\n          _context3.next = 4;\n          return onDelete === null || onDelete === void 0 ? void 0 : onDelete(recordKey, row);\n        case 4:\n          res = _context3.sent;\n          setLoading(false);\n          return _context3.abrupt(\"return\", res);\n        case 9:\n          _context3.prev = 9;\n          _context3.t0 = _context3[\"catch\"](0);\n          // eslint-disable-next-line no-console\n          console.log(_context3.t0);\n          setLoading(false);\n          return _context3.abrupt(\"return\", null);\n        case 14:\n        case \"end\":\n          return _context3.stop();\n      }\n    }, _callee3, null, [[0, 9]]);\n  })));\n  return children !== false ? /*#__PURE__*/_jsx(Popconfirm, {\n    title: deletePopconfirmMessage,\n    onConfirm: function onConfirm() {\n      return _onConfirm();\n    },\n    children: /*#__PURE__*/_jsxs(\"a\", {\n      children: [loading ? /*#__PURE__*/_jsx(LoadingOutlined, {\n        style: {\n          marginInlineEnd: 8\n        }\n      }) : null, children || '删除']\n    })\n  }, \"delete\") : null;\n};\nvar CancelEditableAction = function CancelEditableAction(props) {\n  var recordKey = props.recordKey,\n    tableName = props.tableName,\n    newLineConfig = props.newLineConfig,\n    editorType = props.editorType,\n    onCancel = props.onCancel,\n    cancelEditable = props.cancelEditable,\n    row = props.row,\n    cancelText = props.cancelText;\n  var context = useContext(ProFormContext);\n  var form = Form.useFormInstance();\n  return /*#__PURE__*/_jsx(\"a\", {\n    onClick: /*#__PURE__*/function () {\n      var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(e) {\n        var _context$getFieldForm2;\n        var isMapEditor, namePath, fields, record, res;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              e.stopPropagation();\n              e.preventDefault();\n              isMapEditor = editorType === 'Map';\n              namePath = [tableName, recordKey].flat(1).filter(Boolean);\n              fields = ((_context$getFieldForm2 = context.getFieldFormatValue) === null || _context$getFieldForm2 === void 0 ? void 0 : _context$getFieldForm2.call(context, namePath)) || form.getFieldValue(namePath);\n              record = isMapEditor ? set({}, namePath, fields) : fields;\n              _context4.next = 8;\n              return onCancel === null || onCancel === void 0 ? void 0 : onCancel(recordKey, record, row, newLineConfig);\n            case 8:\n              res = _context4.sent;\n              cancelEditable(recordKey);\n              /** 充值为默认值，不然编辑的行会丢掉 */\n              form.setFieldsValue(_defineProperty({}, recordKey, isMapEditor ? get(row, namePath) : row));\n              return _context4.abrupt(\"return\", res);\n            case 12:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4);\n      }));\n      return function (_x2) {\n        return _ref6.apply(this, arguments);\n      };\n    }(),\n    children: cancelText || '取消'\n  }, \"cancel\");\n};\nexport function defaultActionRender(row, config) {\n  var recordKey = config.recordKey,\n    newLineConfig = config.newLineConfig,\n    saveText = config.saveText,\n    deleteText = config.deleteText;\n  var SaveEditableActionRef = /*#__PURE__*/forwardRef(SaveEditableAction);\n  var saveRef = /*#__PURE__*/createRef();\n  return {\n    save: /*#__PURE__*/_jsx(SaveEditableActionRef, _objectSpread(_objectSpread({}, config), {}, {\n      row: row,\n      ref: saveRef,\n      children: saveText\n    }), 'save' + recordKey),\n    saveRef: saveRef,\n    delete: (newLineConfig === null || newLineConfig === void 0 ? void 0 : newLineConfig.options.recordKey) !== recordKey ? /*#__PURE__*/_jsx(DeleteEditableAction, _objectSpread(_objectSpread({}, config), {}, {\n      row: row,\n      children: deleteText\n    }), 'delete' + recordKey) : undefined,\n    cancel: /*#__PURE__*/_jsx(CancelEditableAction, _objectSpread(_objectSpread({}, config), {}, {\n      row: row\n    }), 'cancel' + recordKey)\n  };\n}\n\n/**\n * 一个方便的hooks 用于维护编辑的状态\n *\n * @param props\n */\nexport function useEditableArray(props) {\n  var _useState = useState(undefined),\n    _useState2 = _slicedToArray(_useState, 2),\n    newLineRecordCache = _useState2[0],\n    setNewLineRecordCache = _useState2[1];\n  var dataSourceKeyIndexMapRef = useRef(new Map());\n  var newLineRecordRef = useRef(undefined);\n  useDeepCompareEffectDebounce(function () {\n    var map = new Map();\n    //存在children时会覆盖Map的key,导致使用数组索引查找key错误\n    var loopGetKey = function loopGetKey(dataSource, parentKey) {\n      dataSource === null || dataSource === void 0 ? void 0 : dataSource.forEach(function (record, index) {\n        var _recordKeyToString2;\n        var key = parentKey === undefined || parentKey === null ? index.toString() : parentKey + '_' + index.toString();\n        map.set(key, recordKeyToString(props.getRowKey(record, -1)));\n        map.set((_recordKeyToString2 = recordKeyToString(props.getRowKey(record, -1))) === null || _recordKeyToString2 === void 0 ? void 0 : _recordKeyToString2.toString(), key);\n        if (props.childrenColumnName && record[props.childrenColumnName]) {\n          loopGetKey(record[props.childrenColumnName], key);\n        }\n      });\n    };\n    loopGetKey(props.dataSource);\n    dataSourceKeyIndexMapRef.current = map;\n  }, [props.dataSource]);\n\n  // 这里这么做是为了存上次的状态，不然每次存一下再拿\n  newLineRecordRef.current = newLineRecordCache;\n  var editableType = props.type || 'single';\n  var _useLazyKVMap = useLazyKVMap(props.dataSource, 'children', props.getRowKey),\n    _useLazyKVMap2 = _slicedToArray(_useLazyKVMap, 1),\n    getRecordByKey = _useLazyKVMap2[0];\n  var _useMergedState = useMergedState([], {\n      value: props.editableKeys,\n      onChange: props.onChange ? function (keys) {\n        var _props$onChange, _keys$filter, _keys$map$filter;\n        props === null || props === void 0 ? void 0 : (_props$onChange = props.onChange) === null || _props$onChange === void 0 ? void 0 : _props$onChange.call(props,\n        // 计算编辑的key\n        (_keys$filter = keys === null || keys === void 0 ? void 0 : keys.filter(function (key) {\n          return key !== undefined;\n        })) !== null && _keys$filter !== void 0 ? _keys$filter : [],\n        // 计算编辑的行\n        (_keys$map$filter = keys === null || keys === void 0 ? void 0 : keys.map(function (key) {\n          return getRecordByKey(key);\n        }).filter(function (key) {\n          return key !== undefined;\n        })) !== null && _keys$map$filter !== void 0 ? _keys$map$filter : []);\n      } : undefined\n    }),\n    _useMergedState2 = _slicedToArray(_useMergedState, 2),\n    editableKeys = _useMergedState2[0],\n    setEditableRowKeys = _useMergedState2[1];\n\n  /** 一个用来标志的set 提供了方便的 api 来去重什么的 */\n  var editableKeysSet = useMemo(function () {\n    var keys = editableType === 'single' ? editableKeys === null || editableKeys === void 0 ? void 0 : editableKeys.slice(0, 1) : editableKeys;\n    return new Set(keys);\n  }, [(editableKeys || []).join(','), editableType]);\n  var editableKeysRef = usePrevious(editableKeys);\n\n  /** 这行是不是编辑状态 */\n  var isEditable = useRefFunction(function (row) {\n    var _props$getRowKey, _props$getRowKey$toSt, _props$getRowKey2, _props$getRowKey2$toS;\n    // 为了兼容一下name 模式的 indexKey，所以需要判断两次，一次是index，一次是没有 index 的\n    var recordKeyOrIndex = (_props$getRowKey = props.getRowKey(row, row.index)) === null || _props$getRowKey === void 0 ? void 0 : (_props$getRowKey$toSt = _props$getRowKey.toString) === null || _props$getRowKey$toSt === void 0 ? void 0 : _props$getRowKey$toSt.call(_props$getRowKey);\n    // 这里是不设置 index 的地方\n    var recordKey = (_props$getRowKey2 = props.getRowKey(row, -1)) === null || _props$getRowKey2 === void 0 ? void 0 : (_props$getRowKey2$toS = _props$getRowKey2.toString) === null || _props$getRowKey2$toS === void 0 ? void 0 : _props$getRowKey2$toS.call(_props$getRowKey2);\n\n    // 都转化为了字符串，不然 number 和 string\n    var stringEditableKeys = editableKeys === null || editableKeys === void 0 ? void 0 : editableKeys.map(function (key) {\n      return key === null || key === void 0 ? void 0 : key.toString();\n    });\n    var stringEditableKeysRef = (editableKeysRef === null || editableKeysRef === void 0 ? void 0 : editableKeysRef.map(function (key) {\n      return key === null || key === void 0 ? void 0 : key.toString();\n    })) || [];\n    var preIsEditable = props.tableName && !!(stringEditableKeysRef !== null && stringEditableKeysRef !== void 0 && stringEditableKeysRef.includes(recordKey)) || !!(stringEditableKeysRef !== null && stringEditableKeysRef !== void 0 && stringEditableKeysRef.includes(recordKeyOrIndex));\n    return {\n      recordKey: recordKey,\n      isEditable: props.tableName && (stringEditableKeys === null || stringEditableKeys === void 0 ? void 0 : stringEditableKeys.includes(recordKey)) || (stringEditableKeys === null || stringEditableKeys === void 0 ? void 0 : stringEditableKeys.includes(recordKeyOrIndex)),\n      preIsEditable: preIsEditable\n    };\n  });\n\n  /**\n   * 进入编辑状态\n   *\n   * @param recordKey\n   */\n  var startEditable = useRefFunction(function (recordKey) {\n    // 如果是单行的话，不允许多行编辑\n    if (editableKeysSet.size > 0 && editableType === 'single' && props.onlyOneLineEditorAlertMessage !== false) {\n      warning(props.onlyOneLineEditorAlertMessage || '只能同时编辑一行');\n      return false;\n    }\n    editableKeysSet.add(recordKey);\n    setEditableRowKeys(Array.from(editableKeysSet));\n    return true;\n  });\n\n  /**\n   * 退出编辑状态\n   *\n   * @param recordKey\n   */\n  var cancelEditable = useRefFunction( /*#__PURE__*/function () {\n    var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(recordKey, needReTry) {\n      var relayKey, key;\n      return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n        while (1) switch (_context5.prev = _context5.next) {\n          case 0:\n            relayKey = recordKeyToString(recordKey).toString();\n            key = dataSourceKeyIndexMapRef.current.get(relayKey);\n            /** 如果没找到key，转化一下再去找 */\n            if (!(!editableKeysSet.has(relayKey) && key && (needReTry !== null && needReTry !== void 0 ? needReTry : true) && props.tableName)) {\n              _context5.next = 5;\n              break;\n            }\n            cancelEditable(key, false);\n            return _context5.abrupt(\"return\");\n          case 5:\n            /** 如果这个是 new Line 直接删除 */\n            if (newLineRecordCache && newLineRecordCache.options.recordKey === recordKey) {\n              setNewLineRecordCache(undefined);\n            }\n            editableKeysSet.delete(relayKey);\n            editableKeysSet.delete(recordKeyToString(recordKey));\n            setEditableRowKeys(Array.from(editableKeysSet));\n            return _context5.abrupt(\"return\", true);\n          case 10:\n          case \"end\":\n            return _context5.stop();\n        }\n      }, _callee5);\n    }));\n    return function (_x3, _x4) {\n      return _ref7.apply(this, arguments);\n    };\n  }());\n  var propsOnValuesChange = useDebounceFn( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6() {\n    var _props$onValuesChange;\n    var _len,\n      rest,\n      _key,\n      _args6 = arguments;\n    return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n      while (1) switch (_context6.prev = _context6.next) {\n        case 0:\n          for (_len = _args6.length, rest = new Array(_len), _key = 0; _key < _len; _key++) {\n            rest[_key] = _args6[_key];\n          }\n          //@ts-ignore\n          (_props$onValuesChange = props.onValuesChange) === null || _props$onValuesChange === void 0 ? void 0 : _props$onValuesChange.call.apply(_props$onValuesChange, [props].concat(rest));\n        case 2:\n        case \"end\":\n          return _context6.stop();\n      }\n    }, _callee6);\n  })), 64);\n  var onValuesChange = useRefFunction(function (value, values) {\n    var _Object$keys$pop;\n    if (!props.onValuesChange) {\n      return;\n    }\n    var dataSource = props.dataSource;\n\n    // 这里是把正在编辑中的所有表单数据都修改掉\n    // 不然会用 props 里面的 dataSource，数据只有正在编辑中的\n    // Object.keys(get(values, [props.tableName || ''].flat(1)) || values).forEach((recordKey) => {\n    editableKeys === null || editableKeys === void 0 ? void 0 : editableKeys.forEach(function (eachRecordKey) {\n      if ((newLineRecordCache === null || newLineRecordCache === void 0 ? void 0 : newLineRecordCache.options.recordKey) === eachRecordKey) return;\n      var recordKey = eachRecordKey.toString();\n      // 如果数据在这个 form 中没有展示，也不显示\n      var editRow = get(values, [props.tableName || '', recordKey].flat(1).filter(function (key) {\n        return key || key === 0;\n      }));\n      if (!editRow) return;\n      dataSource = editableRowByKey({\n        data: dataSource,\n        getRowKey: props.getRowKey,\n        row: editRow,\n        key: recordKey,\n        childrenColumnName: props.childrenColumnName || 'children'\n      }, 'update');\n    });\n    var relayValue = props.tableName ? get(value, [props.tableName || ''].flat(1)) : value;\n    var recordKey = (_Object$keys$pop = Object.keys(relayValue || {}).pop()) === null || _Object$keys$pop === void 0 ? void 0 : _Object$keys$pop.toString();\n\n    //从form 和 cache 中取得数据\n    var newLineRecordData = _objectSpread(_objectSpread({}, newLineRecordCache === null || newLineRecordCache === void 0 ? void 0 : newLineRecordCache.defaultValue), get(values, [props.tableName || '', recordKey.toString()].flat(1).filter(function (key) {\n      return key || key === 0;\n    })));\n\n    /** 如果已经在 dataSource 中存在了，直接 find */\n    var editRow = dataSourceKeyIndexMapRef.current.has(recordKeyToString(recordKey)) ? dataSource.find(function (item, index) {\n      var _props$getRowKey3;\n      var key = (_props$getRowKey3 = props.getRowKey(item, index)) === null || _props$getRowKey3 === void 0 ? void 0 : _props$getRowKey3.toString();\n      return key === recordKey;\n    }) : newLineRecordData;\n    propsOnValuesChange.run(editRow || newLineRecordData, dataSource);\n  });\n  var saveRefsMap = useRef(new Map());\n  useEffect(function () {\n    // 确保只保留编辑状态的，其它的都删除掉\n    saveRefsMap.current.forEach(function (ref, key) {\n      if (!editableKeysSet.has(key)) {\n        saveRefsMap.current.delete(key);\n      }\n    });\n  }, [saveRefsMap, editableKeysSet]);\n  /**\n   * 保存编辑行\n   *\n   * @param recordKey\n   * @param needReTry\n   */\n  var saveEditable = useRefFunction( /*#__PURE__*/function () {\n    var _ref9 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7(recordKey, needReTry) {\n      var relayKey, key, saveRef, _saveRef$current;\n      return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n        while (1) switch (_context7.prev = _context7.next) {\n          case 0:\n            relayKey = recordKeyToString(recordKey);\n            key = dataSourceKeyIndexMapRef.current.get(recordKey.toString());\n            /** 如果没找到key，转化一下再去找 */\n            if (!(!editableKeysSet.has(relayKey) && key && (needReTry !== null && needReTry !== void 0 ? needReTry : true) && props.tableName)) {\n              _context7.next = 6;\n              break;\n            }\n            _context7.next = 5;\n            return saveEditable(key, false);\n          case 5:\n            return _context7.abrupt(\"return\", _context7.sent);\n          case 6:\n            saveRef = saveRefsMap.current.get(relayKey) || saveRefsMap.current.get(relayKey.toString());\n            _context7.prev = 7;\n            _context7.next = 10;\n            return saveRef === null || saveRef === void 0 ? void 0 : (_saveRef$current = saveRef.current) === null || _saveRef$current === void 0 ? void 0 : _saveRef$current.save();\n          case 10:\n            _context7.next = 15;\n            break;\n          case 12:\n            _context7.prev = 12;\n            _context7.t0 = _context7[\"catch\"](7);\n            return _context7.abrupt(\"return\", false);\n          case 15:\n            editableKeysSet.delete(relayKey);\n            editableKeysSet.delete(relayKey.toString());\n            setEditableRowKeys(Array.from(editableKeysSet));\n            return _context7.abrupt(\"return\", true);\n          case 19:\n          case \"end\":\n            return _context7.stop();\n        }\n      }, _callee7, null, [[7, 12]]);\n    }));\n    return function (_x5, _x6) {\n      return _ref9.apply(this, arguments);\n    };\n  }());\n\n  /**\n   * 同时只能支持一行,取消之后数据消息，不会触发 dataSource\n   *\n   * @param row\n   * @param options\n   * @name 增加新的行\n   */\n  var addEditRecord = useRefFunction(function (row, options) {\n    if (options !== null && options !== void 0 && options.parentKey && !dataSourceKeyIndexMapRef.current.has(recordKeyToString(options === null || options === void 0 ? void 0 : options.parentKey).toString())) {\n      console.warn(\"can't find record by key\", options === null || options === void 0 ? void 0 : options.parentKey);\n      return false;\n    }\n    // 暂时不支持多行新增\n    if (newLineRecordRef.current && props.onlyAddOneLineAlertMessage !== false) {\n      warning(props.onlyAddOneLineAlertMessage || '只能新增一行');\n      return false;\n    }\n    // 如果是单行的话，不允许多行编辑\n    if (editableKeysSet.size > 0 && editableType === 'single' && props.onlyOneLineEditorAlertMessage !== false) {\n      warning(props.onlyOneLineEditorAlertMessage || '只能同时编辑一行');\n      return false;\n    }\n    // 防止多次渲染\n    var recordKey = props.getRowKey(row, -1);\n    if (!recordKey) {\n      noteOnce(!!recordKey, '请设置 recordCreatorProps.record 并返回一个唯一的key  \\n  https://procomponents.ant.design/components/editable-table#editable-%E6%96%B0%E5%BB%BA%E8%A1%8C');\n      throw new Error('请设置 recordCreatorProps.record 并返回一个唯一的key');\n    }\n    editableKeysSet.add(recordKey);\n    setEditableRowKeys(Array.from(editableKeysSet));\n\n    // 如果是dataSource 新增模式的话，取消再开始编辑，\n    // 这样就可以把新增到 dataSource的数据进入编辑模式了\n    // [a,b,cache] => [a,b,c]\n    if ((options === null || options === void 0 ? void 0 : options.newRecordType) === 'dataSource' || props.tableName) {\n      var _recordKeyToString3;\n      var actionProps = {\n        data: props.dataSource,\n        getRowKey: props.getRowKey,\n        row: _objectSpread(_objectSpread({}, row), {}, {\n          map_row_parentKey: options !== null && options !== void 0 && options.parentKey ? (_recordKeyToString3 = recordKeyToString(options === null || options === void 0 ? void 0 : options.parentKey)) === null || _recordKeyToString3 === void 0 ? void 0 : _recordKeyToString3.toString() : undefined\n        }),\n        key: recordKey,\n        childrenColumnName: props.childrenColumnName || 'children'\n      };\n      props.setDataSource(editableRowByKey(actionProps, (options === null || options === void 0 ? void 0 : options.position) === 'top' ? 'top' : 'update'));\n    } else {\n      setNewLineRecordCache({\n        defaultValue: row,\n        options: _objectSpread(_objectSpread({}, options), {}, {\n          recordKey: recordKey\n        })\n      });\n    }\n    return true;\n  });\n\n  // Internationalization\n  var intl = useIntl();\n  var saveText = (props === null || props === void 0 ? void 0 : props.saveText) || intl.getMessage('editableTable.action.save', '保存');\n  var deleteText = (props === null || props === void 0 ? void 0 : props.deleteText) || intl.getMessage('editableTable.action.delete', '删除');\n  var cancelText = (props === null || props === void 0 ? void 0 : props.cancelText) || intl.getMessage('editableTable.action.cancel', '取消');\n  var actionSaveRef = useRefFunction( /*#__PURE__*/function () {\n    var _ref10 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee8(recordKey, editRow, originRow, newLine) {\n      var _props$onSave, _recordKeyToString4, _options$parentKey;\n      var res, _ref11, options, actionProps;\n      return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n        while (1) switch (_context8.prev = _context8.next) {\n          case 0:\n            // 保存时解除编辑模式,这个要提前一下不然数据会被清空\n            cancelEditable(recordKey);\n            _context8.next = 3;\n            return props === null || props === void 0 ? void 0 : (_props$onSave = props.onSave) === null || _props$onSave === void 0 ? void 0 : _props$onSave.call(props, recordKey, editRow, originRow, newLine);\n          case 3:\n            res = _context8.sent;\n            _ref11 = newLine || newLineRecordRef.current || {}, options = _ref11.options;\n            if (!(!(options !== null && options !== void 0 && options.parentKey) && (options === null || options === void 0 ? void 0 : options.recordKey) === recordKey)) {\n              _context8.next = 8;\n              break;\n            }\n            if ((options === null || options === void 0 ? void 0 : options.position) === 'top') {\n              props.setDataSource([editRow].concat(_toConsumableArray(props.dataSource)));\n            } else {\n              props.setDataSource([].concat(_toConsumableArray(props.dataSource), [editRow]));\n            }\n            return _context8.abrupt(\"return\", res);\n          case 8:\n            actionProps = {\n              data: props.dataSource,\n              getRowKey: props.getRowKey,\n              row: options ? _objectSpread(_objectSpread({}, editRow), {}, {\n                map_row_parentKey: (_recordKeyToString4 = recordKeyToString((_options$parentKey = options === null || options === void 0 ? void 0 : options.parentKey) !== null && _options$parentKey !== void 0 ? _options$parentKey : '')) === null || _recordKeyToString4 === void 0 ? void 0 : _recordKeyToString4.toString()\n              }) : editRow,\n              key: recordKey,\n              childrenColumnName: props.childrenColumnName || 'children'\n            };\n            props.setDataSource(editableRowByKey(actionProps, (options === null || options === void 0 ? void 0 : options.position) === 'top' ? 'top' : 'update'));\n            return _context8.abrupt(\"return\", res);\n          case 11:\n          case \"end\":\n            return _context8.stop();\n        }\n      }, _callee8);\n    }));\n    return function (_x7, _x8, _x9, _x10) {\n      return _ref10.apply(this, arguments);\n    };\n  }());\n  var actionDeleteRef = useRefFunction( /*#__PURE__*/function () {\n    var _ref12 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee9(recordKey, editRow) {\n      var _props$onDelete;\n      var actionProps, res;\n      return _regeneratorRuntime().wrap(function _callee9$(_context9) {\n        while (1) switch (_context9.prev = _context9.next) {\n          case 0:\n            actionProps = {\n              data: props.dataSource,\n              getRowKey: props.getRowKey,\n              row: editRow,\n              key: recordKey,\n              childrenColumnName: props.childrenColumnName || 'children'\n            };\n            _context9.next = 3;\n            return props === null || props === void 0 ? void 0 : (_props$onDelete = props.onDelete) === null || _props$onDelete === void 0 ? void 0 : _props$onDelete.call(props, recordKey, editRow);\n          case 3:\n            res = _context9.sent;\n            _context9.next = 6;\n            return cancelEditable(recordKey);\n          case 6:\n            props.setDataSource(editableRowByKey(actionProps, 'delete'));\n            return _context9.abrupt(\"return\", res);\n          case 8:\n          case \"end\":\n            return _context9.stop();\n        }\n      }, _callee9);\n    }));\n    return function (_x11, _x12) {\n      return _ref12.apply(this, arguments);\n    };\n  }());\n  var actionCancelRef = useRefFunction( /*#__PURE__*/function () {\n    var _ref13 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee10(recordKey, editRow, originRow, newLine) {\n      var _props$onCancel;\n      var res;\n      return _regeneratorRuntime().wrap(function _callee10$(_context10) {\n        while (1) switch (_context10.prev = _context10.next) {\n          case 0:\n            _context10.next = 2;\n            return props === null || props === void 0 ? void 0 : (_props$onCancel = props.onCancel) === null || _props$onCancel === void 0 ? void 0 : _props$onCancel.call(props, recordKey, editRow, originRow, newLine);\n          case 2:\n            res = _context10.sent;\n            return _context10.abrupt(\"return\", res);\n          case 4:\n          case \"end\":\n            return _context10.stop();\n        }\n      }, _callee10);\n    }));\n    return function (_x13, _x14, _x15, _x16) {\n      return _ref13.apply(this, arguments);\n    };\n  }());\n  var actionRender = function actionRender(row) {\n    var key = props.getRowKey(row, row.index);\n    var config = {\n      saveText: saveText,\n      cancelText: cancelText,\n      deleteText: deleteText,\n      addEditRecord: addEditRecord,\n      recordKey: key,\n      cancelEditable: cancelEditable,\n      index: row.index,\n      tableName: props.tableName,\n      newLineConfig: newLineRecordCache,\n      onCancel: actionCancelRef,\n      onDelete: actionDeleteRef,\n      onSave: actionSaveRef,\n      editableKeys: editableKeys,\n      setEditableRowKeys: setEditableRowKeys,\n      deletePopconfirmMessage: props.deletePopconfirmMessage || \"\".concat(intl.getMessage('deleteThisLine', '删除此行'), \"?\")\n    };\n    var renderResult = defaultActionRender(row, config);\n    // 缓存一下saveRef\n    if (props.tableName) {\n      saveRefsMap.current.set(dataSourceKeyIndexMapRef.current.get(recordKeyToString(key)) || recordKeyToString(key), renderResult.saveRef);\n    } else {\n      saveRefsMap.current.set(recordKeyToString(key), renderResult.saveRef);\n    }\n    if (props.actionRender) return props.actionRender(row, config, {\n      save: renderResult.save,\n      delete: renderResult.delete,\n      cancel: renderResult.cancel\n    });\n    return [renderResult.save, renderResult.delete, renderResult.cancel];\n  };\n  return {\n    editableKeys: editableKeys,\n    setEditableRowKeys: setEditableRowKeys,\n    isEditable: isEditable,\n    actionRender: actionRender,\n    startEditable: startEditable,\n    cancelEditable: cancelEditable,\n    addEditRecord: addEditRecord,\n    saveEditable: saveEditable,\n    newLineRecord: newLineRecordCache,\n    preEditableKeys: editableKeysRef,\n    onValuesChange: onValuesChange\n  };\n}","map":{"version":3,"names":["_toConsumableArray","_regeneratorRuntime","_toArray","_asyncToGenerator","_slicedToArray","_defineProperty","_objectWithoutProperties","_objectSpread","_typeof","_excluded","_excluded2","_excluded3","LoadingOutlined","useIntl","Form","message","Popconfirm","useLazyKVMap","useMergedState","get","set","noteOnce","React","createRef","forwardRef","useContext","useEffect","useImperativeHandle","useMemo","useRef","useState","useDebounceFn","useRefFunction","ProFormContext","useDeepCompareEffectDebounce","usePrevious","merge","useMountMergeState","jsx","_jsx","jsxs","_jsxs","warning","messageStr","warn","recordKeyToString","rowKey","Array","isArray","join","editableRowByKey","keyProps","action","_recordKeyToString","getRowKey","row","data","_keyProps$childrenCol","childrenColumnName","key","toString","kvMap","Map","dig","records","map_row_parentKey","map_row_index","forEach","record","index","eachIndex","recordKey","newRecord","map_row_key","children","undefined","delete","fill","map","kvArrayMap","kvSource","fillNewRecord","fillChildren","arguments","length","value","rest","has","_kvArrayMap$get","push","_kvArrayMap$get2","item","SaveEditableAction","_ref","ref","onSave","newLineConfig","editorType","tableName","context","form","useFormInstance","_useMountMergeState","_useMountMergeState2","loading","setLoading","save","mark","_callee","_context$getFieldForm","isMapEditor","namePath","fields","_recordKey","recordKeyPath","curValue","res","wrap","_callee$","_context","prev","next","flat","filter","Boolean","validateFields","recursive","getFieldFormatValue","call","getFieldValue","slice","sent","abrupt","t0","console","log","stop","onClick","_ref3","_callee2","e","_callee2$","_context2","stopPropagation","preventDefault","_x","apply","style","marginInlineEnd","DeleteEditableAction","_ref4","onDelete","deletePopconfirmMessage","_useMountMergeState3","_useMountMergeState4","_onConfirm","_callee3","_callee3$","_context3","title","onConfirm","CancelEditableAction","props","onCancel","cancelEditable","cancelText","_ref6","_callee4","_context$getFieldForm2","_callee4$","_context4","setFieldsValue","_x2","defaultActionRender","config","saveText","deleteText","SaveEditableActionRef","saveRef","options","cancel","useEditableArray","_useState","_useState2","newLineRecordCache","setNewLineRecordCache","dataSourceKeyIndexMapRef","newLineRecordRef","loopGetKey","dataSource","parentKey","_recordKeyToString2","current","editableType","type","_useLazyKVMap","_useLazyKVMap2","getRecordByKey","_useMergedState","editableKeys","onChange","keys","_props$onChange","_keys$filter","_keys$map$filter","_useMergedState2","setEditableRowKeys","editableKeysSet","Set","editableKeysRef","isEditable","_props$getRowKey","_props$getRowKey$toSt","_props$getRowKey2","_props$getRowKey2$toS","recordKeyOrIndex","stringEditableKeys","stringEditableKeysRef","preIsEditable","includes","startEditable","size","onlyOneLineEditorAlertMessage","add","from","_ref7","_callee5","needReTry","relayKey","_callee5$","_context5","_x3","_x4","propsOnValuesChange","_callee6","_props$onValuesChange","_len","_key","_args6","_callee6$","_context6","onValuesChange","concat","values","_Object$keys$pop","eachRecordKey","editRow","relayValue","Object","pop","newLineRecordData","defaultValue","find","_props$getRowKey3","run","saveRefsMap","saveEditable","_ref9","_callee7","_saveRef$current","_callee7$","_context7","_x5","_x6","addEditRecord","onlyAddOneLineAlertMessage","Error","newRecordType","_recordKeyToString3","actionProps","setDataSource","position","intl","getMessage","actionSaveRef","_ref10","_callee8","originRow","newLine","_props$onSave","_recordKeyToString4","_options$parentKey","_ref11","_callee8$","_context8","_x7","_x8","_x9","_x10","actionDeleteRef","_ref12","_callee9","_props$onDelete","_callee9$","_context9","_x11","_x12","actionCancelRef","_ref13","_callee10","_props$onCancel","_callee10$","_context10","_x13","_x14","_x15","_x16","actionRender","renderResult","newLineRecord","preEditableKeys"],"sources":["D:/LearnDeveloper/ReactJS/student-management-infor/node_modules/@ant-design/pro-utils/es/useEditableArray/index.js"],"sourcesContent":["import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"@babel/runtime/helpers/esm/regeneratorRuntime\";\nimport _toArray from \"@babel/runtime/helpers/esm/toArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\nvar _excluded = [\"map_row_parentKey\"],\n  _excluded2 = [\"map_row_parentKey\", \"map_row_key\"],\n  _excluded3 = [\"map_row_key\"];\n/* eslint-disable react-hooks/exhaustive-deps */\nimport { LoadingOutlined } from '@ant-design/icons';\nimport { useIntl } from '@ant-design/pro-provider';\nimport { Form, message, Popconfirm } from 'antd';\nimport useLazyKVMap from \"antd/es/table/hooks/useLazyKVMap\";\nimport useMergedState from \"rc-util/es/hooks/useMergedState\";\nimport get from \"rc-util/es/utils/get\";\nimport set from \"rc-util/es/utils/set\";\nimport { noteOnce } from \"rc-util/es/warning\";\nimport React, { createRef, forwardRef, useContext, useEffect, useImperativeHandle, useMemo, useRef, useState } from 'react';\nimport { useDebounceFn, useRefFunction } from '..';\nimport { ProFormContext } from \"../components/ProFormContext\";\nimport { useDeepCompareEffectDebounce } from \"../hooks/useDeepCompareEffect\";\nimport { usePrevious } from \"../hooks/usePrevious\";\nimport { merge } from \"../merge\";\nimport { useMountMergeState } from \"../useMountMergeState\";\n\n/**\n * 兼容antd@4 和 antd@5 的warning\n * @param messageStr\n */\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar warning = function warning(messageStr) {\n  // @ts-ignore\n  return (message.warn || message.warning)(messageStr);\n};\nexport var recordKeyToString = function recordKeyToString(rowKey) {\n  if (Array.isArray(rowKey)) return rowKey.join(',');\n  return rowKey;\n};\n/**\n * 使用map 来删除数据，性能一般 但是准确率比较高\n *\n * @param keyProps\n * @param action\n */\nexport function editableRowByKey(keyProps, action) {\n  var _recordKeyToString;\n  var getRowKey = keyProps.getRowKey,\n    row = keyProps.row,\n    data = keyProps.data,\n    _keyProps$childrenCol = keyProps.childrenColumnName,\n    childrenColumnName = _keyProps$childrenCol === void 0 ? 'children' : _keyProps$childrenCol;\n  var key = (_recordKeyToString = recordKeyToString(keyProps.key)) === null || _recordKeyToString === void 0 ? void 0 : _recordKeyToString.toString();\n  var kvMap = new Map();\n\n  /**\n   * 打平这个数组\n   *\n   * @param records\n   * @param parentKey\n   */\n  function dig(records, map_row_parentKey, map_row_index) {\n    records.forEach(function (record, index) {\n      var eachIndex = (map_row_index || 0) * 10 + index;\n      var recordKey = getRowKey(record, eachIndex).toString();\n      // children 取在前面方便拼的时候按照反顺序放回去\n      if (record && _typeof(record) === 'object' && childrenColumnName in record) {\n        dig(record[childrenColumnName] || [], recordKey, eachIndex);\n      }\n      var newRecord = _objectSpread(_objectSpread({}, record), {}, {\n        map_row_key: recordKey,\n        children: undefined,\n        map_row_parentKey: map_row_parentKey\n      });\n      delete newRecord.children;\n      if (!map_row_parentKey) {\n        delete newRecord.map_row_parentKey;\n      }\n      kvMap.set(recordKey, newRecord);\n    });\n  }\n  if (action === 'top') {\n    kvMap.set(key, _objectSpread(_objectSpread({}, kvMap.get(key)), row));\n  }\n  dig(data);\n  if (action === 'update') {\n    kvMap.set(key, _objectSpread(_objectSpread({}, kvMap.get(key)), row));\n  }\n  if (action === 'delete') {\n    kvMap.delete(key);\n  }\n  var fill = function fill(map) {\n    var kvArrayMap = new Map();\n    var kvSource = [];\n    var fillNewRecord = function fillNewRecord() {\n      var fillChildren = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      map.forEach(function (value) {\n        if (value.map_row_parentKey && !value.map_row_key) {\n          var map_row_parentKey = value.map_row_parentKey,\n            rest = _objectWithoutProperties(value, _excluded);\n          if (!kvArrayMap.has(map_row_parentKey)) {\n            kvArrayMap.set(map_row_parentKey, []);\n          }\n          if (fillChildren) {\n            var _kvArrayMap$get;\n            (_kvArrayMap$get = kvArrayMap.get(map_row_parentKey)) === null || _kvArrayMap$get === void 0 ? void 0 : _kvArrayMap$get.push(rest);\n          }\n        }\n      });\n    };\n    fillNewRecord(action === 'top');\n    map.forEach(function (value) {\n      if (value.map_row_parentKey && value.map_row_key) {\n        var _kvArrayMap$get2;\n        var map_row_parentKey = value.map_row_parentKey,\n          map_row_key = value.map_row_key,\n          rest = _objectWithoutProperties(value, _excluded2);\n        if (kvArrayMap.has(map_row_key)) {\n          rest[childrenColumnName] = kvArrayMap.get(map_row_key);\n        }\n        if (!kvArrayMap.has(map_row_parentKey)) {\n          kvArrayMap.set(map_row_parentKey, []);\n        }\n        (_kvArrayMap$get2 = kvArrayMap.get(map_row_parentKey)) === null || _kvArrayMap$get2 === void 0 ? void 0 : _kvArrayMap$get2.push(rest);\n      }\n    });\n    fillNewRecord(action === 'update');\n    map.forEach(function (value) {\n      if (!value.map_row_parentKey) {\n        var map_row_key = value.map_row_key,\n          rest = _objectWithoutProperties(value, _excluded3);\n        if (map_row_key && kvArrayMap.has(map_row_key)) {\n          var item = _objectSpread(_objectSpread({}, rest), {}, _defineProperty({}, childrenColumnName, kvArrayMap.get(map_row_key)));\n          kvSource.push(item);\n          return;\n        }\n        kvSource.push(rest);\n      }\n    });\n    return kvSource;\n  };\n  return fill(kvMap);\n}\n\n/**\n * 保存按钮的dom\n *\n * @param ActionRenderConfig\n */\nexport function SaveEditableAction(_ref, ref) {\n  var recordKey = _ref.recordKey,\n    onSave = _ref.onSave,\n    row = _ref.row,\n    children = _ref.children,\n    newLineConfig = _ref.newLineConfig,\n    editorType = _ref.editorType,\n    tableName = _ref.tableName;\n  var context = useContext(ProFormContext);\n  var form = Form.useFormInstance();\n  var _useMountMergeState = useMountMergeState(false),\n    _useMountMergeState2 = _slicedToArray(_useMountMergeState, 2),\n    loading = _useMountMergeState2[0],\n    setLoading = _useMountMergeState2[1];\n  var save = useRefFunction( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n    var _context$getFieldForm, isMapEditor, namePath, fields, _recordKey, recordKeyPath, curValue, data, res;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          _context.prev = 0;\n          isMapEditor = editorType === 'Map'; // 为了兼容类型为 array 的 dataIndex,当 recordKey 是一个数组时，用于获取表单值的 key 只取第一项，\n          // 从表单中获取回来之后，再根据 namepath 获取具体的某个字段并设置\n          namePath = [tableName, Array.isArray(recordKey) ? recordKey[0] : recordKey].map(function (key) {\n            return key === null || key === void 0 ? void 0 : key.toString();\n          }).flat(1).filter(Boolean);\n          setLoading(true);\n          // @ts-expect-error\n          _context.next = 6;\n          return form.validateFields(namePath, {\n            recursive: true\n          });\n        case 6:\n          fields = ((_context$getFieldForm = context.getFieldFormatValue) === null || _context$getFieldForm === void 0 ? void 0 : _context$getFieldForm.call(context, namePath)) || form.getFieldValue(namePath); // 处理 dataIndex 为数组的情况\n          if (Array.isArray(recordKey) && recordKey.length > 1) {\n            // 获取 namepath\n            _recordKey = _toArray(recordKey), recordKeyPath = _recordKey.slice(1); // 将目标值获取出来并设置到 fields 当中\n            curValue = get(fields, recordKeyPath);\n            set(fields, recordKeyPath, curValue);\n          }\n          data = isMapEditor ? set({}, namePath, fields, true) : fields; // 获取数据并保存\n          _context.next = 11;\n          return onSave === null || onSave === void 0 ? void 0 : onSave(recordKey,\n          // 如果是 map 模式，fields 就是一个值，所以需要set 到对象中\n          // 数据模式 fields 是一个对象，所以不需要\n          merge({}, row, data), row, newLineConfig);\n        case 11:\n          res = _context.sent;\n          setLoading(false);\n          return _context.abrupt(\"return\", res);\n        case 16:\n          _context.prev = 16;\n          _context.t0 = _context[\"catch\"](0);\n          // eslint-disable-next-line no-console\n          console.log(_context.t0);\n          setLoading(false);\n          throw _context.t0;\n        case 21:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee, null, [[0, 16]]);\n  })));\n  useImperativeHandle(ref, function () {\n    return {\n      save: save\n    };\n  });\n  return /*#__PURE__*/_jsxs(\"a\", {\n    onClick: /*#__PURE__*/function () {\n      var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e) {\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              e.stopPropagation();\n              e.preventDefault();\n              _context2.prev = 2;\n              _context2.next = 5;\n              return save();\n            case 5:\n              _context2.next = 9;\n              break;\n            case 7:\n              _context2.prev = 7;\n              _context2.t0 = _context2[\"catch\"](2);\n            case 9:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, null, [[2, 7]]);\n      }));\n      return function (_x) {\n        return _ref3.apply(this, arguments);\n      };\n    }(),\n    children: [loading ? /*#__PURE__*/_jsx(LoadingOutlined, {\n      style: {\n        marginInlineEnd: 8\n      }\n    }) : null, children || '保存']\n  }, \"save\");\n}\n/**\n * 删除按钮 dom\n *\n * @param ActionRenderConfig\n */\nexport var DeleteEditableAction = function DeleteEditableAction(_ref4) {\n  var recordKey = _ref4.recordKey,\n    onDelete = _ref4.onDelete,\n    row = _ref4.row,\n    children = _ref4.children,\n    deletePopconfirmMessage = _ref4.deletePopconfirmMessage;\n  var _useMountMergeState3 = useMountMergeState(function () {\n      return false;\n    }),\n    _useMountMergeState4 = _slicedToArray(_useMountMergeState3, 2),\n    loading = _useMountMergeState4[0],\n    setLoading = _useMountMergeState4[1];\n  var _onConfirm = useRefFunction( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n    var res;\n    return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n      while (1) switch (_context3.prev = _context3.next) {\n        case 0:\n          _context3.prev = 0;\n          setLoading(true);\n          _context3.next = 4;\n          return onDelete === null || onDelete === void 0 ? void 0 : onDelete(recordKey, row);\n        case 4:\n          res = _context3.sent;\n          setLoading(false);\n          return _context3.abrupt(\"return\", res);\n        case 9:\n          _context3.prev = 9;\n          _context3.t0 = _context3[\"catch\"](0);\n          // eslint-disable-next-line no-console\n          console.log(_context3.t0);\n          setLoading(false);\n          return _context3.abrupt(\"return\", null);\n        case 14:\n        case \"end\":\n          return _context3.stop();\n      }\n    }, _callee3, null, [[0, 9]]);\n  })));\n  return children !== false ? /*#__PURE__*/_jsx(Popconfirm, {\n    title: deletePopconfirmMessage,\n    onConfirm: function onConfirm() {\n      return _onConfirm();\n    },\n    children: /*#__PURE__*/_jsxs(\"a\", {\n      children: [loading ? /*#__PURE__*/_jsx(LoadingOutlined, {\n        style: {\n          marginInlineEnd: 8\n        }\n      }) : null, children || '删除']\n    })\n  }, \"delete\") : null;\n};\nvar CancelEditableAction = function CancelEditableAction(props) {\n  var recordKey = props.recordKey,\n    tableName = props.tableName,\n    newLineConfig = props.newLineConfig,\n    editorType = props.editorType,\n    onCancel = props.onCancel,\n    cancelEditable = props.cancelEditable,\n    row = props.row,\n    cancelText = props.cancelText;\n  var context = useContext(ProFormContext);\n  var form = Form.useFormInstance();\n  return /*#__PURE__*/_jsx(\"a\", {\n    onClick: /*#__PURE__*/function () {\n      var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(e) {\n        var _context$getFieldForm2;\n        var isMapEditor, namePath, fields, record, res;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              e.stopPropagation();\n              e.preventDefault();\n              isMapEditor = editorType === 'Map';\n              namePath = [tableName, recordKey].flat(1).filter(Boolean);\n              fields = ((_context$getFieldForm2 = context.getFieldFormatValue) === null || _context$getFieldForm2 === void 0 ? void 0 : _context$getFieldForm2.call(context, namePath)) || form.getFieldValue(namePath);\n              record = isMapEditor ? set({}, namePath, fields) : fields;\n              _context4.next = 8;\n              return onCancel === null || onCancel === void 0 ? void 0 : onCancel(recordKey, record, row, newLineConfig);\n            case 8:\n              res = _context4.sent;\n              cancelEditable(recordKey);\n              /** 充值为默认值，不然编辑的行会丢掉 */\n              form.setFieldsValue(_defineProperty({}, recordKey, isMapEditor ? get(row, namePath) : row));\n              return _context4.abrupt(\"return\", res);\n            case 12:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4);\n      }));\n      return function (_x2) {\n        return _ref6.apply(this, arguments);\n      };\n    }(),\n    children: cancelText || '取消'\n  }, \"cancel\");\n};\nexport function defaultActionRender(row, config) {\n  var recordKey = config.recordKey,\n    newLineConfig = config.newLineConfig,\n    saveText = config.saveText,\n    deleteText = config.deleteText;\n  var SaveEditableActionRef = /*#__PURE__*/forwardRef(SaveEditableAction);\n  var saveRef = /*#__PURE__*/createRef();\n  return {\n    save: /*#__PURE__*/_jsx(SaveEditableActionRef, _objectSpread(_objectSpread({}, config), {}, {\n      row: row,\n      ref: saveRef,\n      children: saveText\n    }), 'save' + recordKey),\n    saveRef: saveRef,\n    delete: (newLineConfig === null || newLineConfig === void 0 ? void 0 : newLineConfig.options.recordKey) !== recordKey ? /*#__PURE__*/_jsx(DeleteEditableAction, _objectSpread(_objectSpread({}, config), {}, {\n      row: row,\n      children: deleteText\n    }), 'delete' + recordKey) : undefined,\n    cancel: /*#__PURE__*/_jsx(CancelEditableAction, _objectSpread(_objectSpread({}, config), {}, {\n      row: row\n    }), 'cancel' + recordKey)\n  };\n}\n\n/**\n * 一个方便的hooks 用于维护编辑的状态\n *\n * @param props\n */\nexport function useEditableArray(props) {\n  var _useState = useState(undefined),\n    _useState2 = _slicedToArray(_useState, 2),\n    newLineRecordCache = _useState2[0],\n    setNewLineRecordCache = _useState2[1];\n  var dataSourceKeyIndexMapRef = useRef(new Map());\n  var newLineRecordRef = useRef(undefined);\n  useDeepCompareEffectDebounce(function () {\n    var map = new Map();\n    //存在children时会覆盖Map的key,导致使用数组索引查找key错误\n    var loopGetKey = function loopGetKey(dataSource, parentKey) {\n      dataSource === null || dataSource === void 0 ? void 0 : dataSource.forEach(function (record, index) {\n        var _recordKeyToString2;\n        var key = parentKey === undefined || parentKey === null ? index.toString() : parentKey + '_' + index.toString();\n        map.set(key, recordKeyToString(props.getRowKey(record, -1)));\n        map.set((_recordKeyToString2 = recordKeyToString(props.getRowKey(record, -1))) === null || _recordKeyToString2 === void 0 ? void 0 : _recordKeyToString2.toString(), key);\n        if (props.childrenColumnName && record[props.childrenColumnName]) {\n          loopGetKey(record[props.childrenColumnName], key);\n        }\n      });\n    };\n    loopGetKey(props.dataSource);\n    dataSourceKeyIndexMapRef.current = map;\n  }, [props.dataSource]);\n\n  // 这里这么做是为了存上次的状态，不然每次存一下再拿\n  newLineRecordRef.current = newLineRecordCache;\n  var editableType = props.type || 'single';\n  var _useLazyKVMap = useLazyKVMap(props.dataSource, 'children', props.getRowKey),\n    _useLazyKVMap2 = _slicedToArray(_useLazyKVMap, 1),\n    getRecordByKey = _useLazyKVMap2[0];\n  var _useMergedState = useMergedState([], {\n      value: props.editableKeys,\n      onChange: props.onChange ? function (keys) {\n        var _props$onChange, _keys$filter, _keys$map$filter;\n        props === null || props === void 0 ? void 0 : (_props$onChange = props.onChange) === null || _props$onChange === void 0 ? void 0 : _props$onChange.call(props, // 计算编辑的key\n        (_keys$filter = keys === null || keys === void 0 ? void 0 : keys.filter(function (key) {\n          return key !== undefined;\n        })) !== null && _keys$filter !== void 0 ? _keys$filter : [], // 计算编辑的行\n        (_keys$map$filter = keys === null || keys === void 0 ? void 0 : keys.map(function (key) {\n          return getRecordByKey(key);\n        }).filter(function (key) {\n          return key !== undefined;\n        })) !== null && _keys$map$filter !== void 0 ? _keys$map$filter : []);\n      } : undefined\n    }),\n    _useMergedState2 = _slicedToArray(_useMergedState, 2),\n    editableKeys = _useMergedState2[0],\n    setEditableRowKeys = _useMergedState2[1];\n\n  /** 一个用来标志的set 提供了方便的 api 来去重什么的 */\n  var editableKeysSet = useMemo(function () {\n    var keys = editableType === 'single' ? editableKeys === null || editableKeys === void 0 ? void 0 : editableKeys.slice(0, 1) : editableKeys;\n    return new Set(keys);\n  }, [(editableKeys || []).join(','), editableType]);\n  var editableKeysRef = usePrevious(editableKeys);\n\n  /** 这行是不是编辑状态 */\n  var isEditable = useRefFunction(function (row) {\n    var _props$getRowKey, _props$getRowKey$toSt, _props$getRowKey2, _props$getRowKey2$toS;\n    // 为了兼容一下name 模式的 indexKey，所以需要判断两次，一次是index，一次是没有 index 的\n    var recordKeyOrIndex = (_props$getRowKey = props.getRowKey(row, row.index)) === null || _props$getRowKey === void 0 ? void 0 : (_props$getRowKey$toSt = _props$getRowKey.toString) === null || _props$getRowKey$toSt === void 0 ? void 0 : _props$getRowKey$toSt.call(_props$getRowKey);\n    // 这里是不设置 index 的地方\n    var recordKey = (_props$getRowKey2 = props.getRowKey(row, -1)) === null || _props$getRowKey2 === void 0 ? void 0 : (_props$getRowKey2$toS = _props$getRowKey2.toString) === null || _props$getRowKey2$toS === void 0 ? void 0 : _props$getRowKey2$toS.call(_props$getRowKey2);\n\n    // 都转化为了字符串，不然 number 和 string\n    var stringEditableKeys = editableKeys === null || editableKeys === void 0 ? void 0 : editableKeys.map(function (key) {\n      return key === null || key === void 0 ? void 0 : key.toString();\n    });\n    var stringEditableKeysRef = (editableKeysRef === null || editableKeysRef === void 0 ? void 0 : editableKeysRef.map(function (key) {\n      return key === null || key === void 0 ? void 0 : key.toString();\n    })) || [];\n    var preIsEditable = props.tableName && !!(stringEditableKeysRef !== null && stringEditableKeysRef !== void 0 && stringEditableKeysRef.includes(recordKey)) || !!(stringEditableKeysRef !== null && stringEditableKeysRef !== void 0 && stringEditableKeysRef.includes(recordKeyOrIndex));\n    return {\n      recordKey: recordKey,\n      isEditable: props.tableName && (stringEditableKeys === null || stringEditableKeys === void 0 ? void 0 : stringEditableKeys.includes(recordKey)) || (stringEditableKeys === null || stringEditableKeys === void 0 ? void 0 : stringEditableKeys.includes(recordKeyOrIndex)),\n      preIsEditable: preIsEditable\n    };\n  });\n\n  /**\n   * 进入编辑状态\n   *\n   * @param recordKey\n   */\n  var startEditable = useRefFunction(function (recordKey) {\n    // 如果是单行的话，不允许多行编辑\n    if (editableKeysSet.size > 0 && editableType === 'single' && props.onlyOneLineEditorAlertMessage !== false) {\n      warning(props.onlyOneLineEditorAlertMessage || '只能同时编辑一行');\n      return false;\n    }\n    editableKeysSet.add(recordKey);\n    setEditableRowKeys(Array.from(editableKeysSet));\n    return true;\n  });\n\n  /**\n   * 退出编辑状态\n   *\n   * @param recordKey\n   */\n  var cancelEditable = useRefFunction( /*#__PURE__*/function () {\n    var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(recordKey, needReTry) {\n      var relayKey, key;\n      return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n        while (1) switch (_context5.prev = _context5.next) {\n          case 0:\n            relayKey = recordKeyToString(recordKey).toString();\n            key = dataSourceKeyIndexMapRef.current.get(relayKey);\n            /** 如果没找到key，转化一下再去找 */\n            if (!(!editableKeysSet.has(relayKey) && key && (needReTry !== null && needReTry !== void 0 ? needReTry : true) && props.tableName)) {\n              _context5.next = 5;\n              break;\n            }\n            cancelEditable(key, false);\n            return _context5.abrupt(\"return\");\n          case 5:\n            /** 如果这个是 new Line 直接删除 */\n            if (newLineRecordCache && newLineRecordCache.options.recordKey === recordKey) {\n              setNewLineRecordCache(undefined);\n            }\n            editableKeysSet.delete(relayKey);\n            editableKeysSet.delete(recordKeyToString(recordKey));\n            setEditableRowKeys(Array.from(editableKeysSet));\n            return _context5.abrupt(\"return\", true);\n          case 10:\n          case \"end\":\n            return _context5.stop();\n        }\n      }, _callee5);\n    }));\n    return function (_x3, _x4) {\n      return _ref7.apply(this, arguments);\n    };\n  }());\n  var propsOnValuesChange = useDebounceFn( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6() {\n    var _props$onValuesChange;\n    var _len,\n      rest,\n      _key,\n      _args6 = arguments;\n    return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n      while (1) switch (_context6.prev = _context6.next) {\n        case 0:\n          for (_len = _args6.length, rest = new Array(_len), _key = 0; _key < _len; _key++) {\n            rest[_key] = _args6[_key];\n          }\n          //@ts-ignore\n          (_props$onValuesChange = props.onValuesChange) === null || _props$onValuesChange === void 0 ? void 0 : _props$onValuesChange.call.apply(_props$onValuesChange, [props].concat(rest));\n        case 2:\n        case \"end\":\n          return _context6.stop();\n      }\n    }, _callee6);\n  })), 64);\n  var onValuesChange = useRefFunction(function (value, values) {\n    var _Object$keys$pop;\n    if (!props.onValuesChange) {\n      return;\n    }\n    var dataSource = props.dataSource;\n\n    // 这里是把正在编辑中的所有表单数据都修改掉\n    // 不然会用 props 里面的 dataSource，数据只有正在编辑中的\n    // Object.keys(get(values, [props.tableName || ''].flat(1)) || values).forEach((recordKey) => {\n    editableKeys === null || editableKeys === void 0 ? void 0 : editableKeys.forEach(function (eachRecordKey) {\n      if ((newLineRecordCache === null || newLineRecordCache === void 0 ? void 0 : newLineRecordCache.options.recordKey) === eachRecordKey) return;\n      var recordKey = eachRecordKey.toString();\n      // 如果数据在这个 form 中没有展示，也不显示\n      var editRow = get(values, [props.tableName || '', recordKey].flat(1).filter(function (key) {\n        return key || key === 0;\n      }));\n      if (!editRow) return;\n      dataSource = editableRowByKey({\n        data: dataSource,\n        getRowKey: props.getRowKey,\n        row: editRow,\n        key: recordKey,\n        childrenColumnName: props.childrenColumnName || 'children'\n      }, 'update');\n    });\n    var relayValue = props.tableName ? get(value, [props.tableName || ''].flat(1)) : value;\n    var recordKey = (_Object$keys$pop = Object.keys(relayValue || {}).pop()) === null || _Object$keys$pop === void 0 ? void 0 : _Object$keys$pop.toString();\n\n    //从form 和 cache 中取得数据\n    var newLineRecordData = _objectSpread(_objectSpread({}, newLineRecordCache === null || newLineRecordCache === void 0 ? void 0 : newLineRecordCache.defaultValue), get(values, [props.tableName || '', recordKey.toString()].flat(1).filter(function (key) {\n      return key || key === 0;\n    })));\n\n    /** 如果已经在 dataSource 中存在了，直接 find */\n    var editRow = dataSourceKeyIndexMapRef.current.has(recordKeyToString(recordKey)) ? dataSource.find(function (item, index) {\n      var _props$getRowKey3;\n      var key = (_props$getRowKey3 = props.getRowKey(item, index)) === null || _props$getRowKey3 === void 0 ? void 0 : _props$getRowKey3.toString();\n      return key === recordKey;\n    }) : newLineRecordData;\n    propsOnValuesChange.run(editRow || newLineRecordData, dataSource);\n  });\n  var saveRefsMap = useRef(new Map());\n  useEffect(function () {\n    // 确保只保留编辑状态的，其它的都删除掉\n    saveRefsMap.current.forEach(function (ref, key) {\n      if (!editableKeysSet.has(key)) {\n        saveRefsMap.current.delete(key);\n      }\n    });\n  }, [saveRefsMap, editableKeysSet]);\n  /**\n   * 保存编辑行\n   *\n   * @param recordKey\n   * @param needReTry\n   */\n  var saveEditable = useRefFunction( /*#__PURE__*/function () {\n    var _ref9 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7(recordKey, needReTry) {\n      var relayKey, key, saveRef, _saveRef$current;\n      return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n        while (1) switch (_context7.prev = _context7.next) {\n          case 0:\n            relayKey = recordKeyToString(recordKey);\n            key = dataSourceKeyIndexMapRef.current.get(recordKey.toString());\n            /** 如果没找到key，转化一下再去找 */\n            if (!(!editableKeysSet.has(relayKey) && key && (needReTry !== null && needReTry !== void 0 ? needReTry : true) && props.tableName)) {\n              _context7.next = 6;\n              break;\n            }\n            _context7.next = 5;\n            return saveEditable(key, false);\n          case 5:\n            return _context7.abrupt(\"return\", _context7.sent);\n          case 6:\n            saveRef = saveRefsMap.current.get(relayKey) || saveRefsMap.current.get(relayKey.toString());\n            _context7.prev = 7;\n            _context7.next = 10;\n            return saveRef === null || saveRef === void 0 ? void 0 : (_saveRef$current = saveRef.current) === null || _saveRef$current === void 0 ? void 0 : _saveRef$current.save();\n          case 10:\n            _context7.next = 15;\n            break;\n          case 12:\n            _context7.prev = 12;\n            _context7.t0 = _context7[\"catch\"](7);\n            return _context7.abrupt(\"return\", false);\n          case 15:\n            editableKeysSet.delete(relayKey);\n            editableKeysSet.delete(relayKey.toString());\n            setEditableRowKeys(Array.from(editableKeysSet));\n            return _context7.abrupt(\"return\", true);\n          case 19:\n          case \"end\":\n            return _context7.stop();\n        }\n      }, _callee7, null, [[7, 12]]);\n    }));\n    return function (_x5, _x6) {\n      return _ref9.apply(this, arguments);\n    };\n  }());\n\n  /**\n   * 同时只能支持一行,取消之后数据消息，不会触发 dataSource\n   *\n   * @param row\n   * @param options\n   * @name 增加新的行\n   */\n  var addEditRecord = useRefFunction(function (row, options) {\n    if (options !== null && options !== void 0 && options.parentKey && !dataSourceKeyIndexMapRef.current.has(recordKeyToString(options === null || options === void 0 ? void 0 : options.parentKey).toString())) {\n      console.warn(\"can't find record by key\", options === null || options === void 0 ? void 0 : options.parentKey);\n      return false;\n    }\n    // 暂时不支持多行新增\n    if (newLineRecordRef.current && props.onlyAddOneLineAlertMessage !== false) {\n      warning(props.onlyAddOneLineAlertMessage || '只能新增一行');\n      return false;\n    }\n    // 如果是单行的话，不允许多行编辑\n    if (editableKeysSet.size > 0 && editableType === 'single' && props.onlyOneLineEditorAlertMessage !== false) {\n      warning(props.onlyOneLineEditorAlertMessage || '只能同时编辑一行');\n      return false;\n    }\n    // 防止多次渲染\n    var recordKey = props.getRowKey(row, -1);\n    if (!recordKey) {\n      noteOnce(!!recordKey, '请设置 recordCreatorProps.record 并返回一个唯一的key  \\n  https://procomponents.ant.design/components/editable-table#editable-%E6%96%B0%E5%BB%BA%E8%A1%8C');\n      throw new Error('请设置 recordCreatorProps.record 并返回一个唯一的key');\n    }\n    editableKeysSet.add(recordKey);\n    setEditableRowKeys(Array.from(editableKeysSet));\n\n    // 如果是dataSource 新增模式的话，取消再开始编辑，\n    // 这样就可以把新增到 dataSource的数据进入编辑模式了\n    // [a,b,cache] => [a,b,c]\n    if ((options === null || options === void 0 ? void 0 : options.newRecordType) === 'dataSource' || props.tableName) {\n      var _recordKeyToString3;\n      var actionProps = {\n        data: props.dataSource,\n        getRowKey: props.getRowKey,\n        row: _objectSpread(_objectSpread({}, row), {}, {\n          map_row_parentKey: options !== null && options !== void 0 && options.parentKey ? (_recordKeyToString3 = recordKeyToString(options === null || options === void 0 ? void 0 : options.parentKey)) === null || _recordKeyToString3 === void 0 ? void 0 : _recordKeyToString3.toString() : undefined\n        }),\n        key: recordKey,\n        childrenColumnName: props.childrenColumnName || 'children'\n      };\n      props.setDataSource(editableRowByKey(actionProps, (options === null || options === void 0 ? void 0 : options.position) === 'top' ? 'top' : 'update'));\n    } else {\n      setNewLineRecordCache({\n        defaultValue: row,\n        options: _objectSpread(_objectSpread({}, options), {}, {\n          recordKey: recordKey\n        })\n      });\n    }\n    return true;\n  });\n\n  // Internationalization\n  var intl = useIntl();\n  var saveText = (props === null || props === void 0 ? void 0 : props.saveText) || intl.getMessage('editableTable.action.save', '保存');\n  var deleteText = (props === null || props === void 0 ? void 0 : props.deleteText) || intl.getMessage('editableTable.action.delete', '删除');\n  var cancelText = (props === null || props === void 0 ? void 0 : props.cancelText) || intl.getMessage('editableTable.action.cancel', '取消');\n  var actionSaveRef = useRefFunction( /*#__PURE__*/function () {\n    var _ref10 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee8(recordKey, editRow, originRow, newLine) {\n      var _props$onSave, _recordKeyToString4, _options$parentKey;\n      var res, _ref11, options, actionProps;\n      return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n        while (1) switch (_context8.prev = _context8.next) {\n          case 0:\n            // 保存时解除编辑模式,这个要提前一下不然数据会被清空\n            cancelEditable(recordKey);\n            _context8.next = 3;\n            return props === null || props === void 0 ? void 0 : (_props$onSave = props.onSave) === null || _props$onSave === void 0 ? void 0 : _props$onSave.call(props, recordKey, editRow, originRow, newLine);\n          case 3:\n            res = _context8.sent;\n            _ref11 = newLine || newLineRecordRef.current || {}, options = _ref11.options;\n            if (!(!(options !== null && options !== void 0 && options.parentKey) && (options === null || options === void 0 ? void 0 : options.recordKey) === recordKey)) {\n              _context8.next = 8;\n              break;\n            }\n            if ((options === null || options === void 0 ? void 0 : options.position) === 'top') {\n              props.setDataSource([editRow].concat(_toConsumableArray(props.dataSource)));\n            } else {\n              props.setDataSource([].concat(_toConsumableArray(props.dataSource), [editRow]));\n            }\n            return _context8.abrupt(\"return\", res);\n          case 8:\n            actionProps = {\n              data: props.dataSource,\n              getRowKey: props.getRowKey,\n              row: options ? _objectSpread(_objectSpread({}, editRow), {}, {\n                map_row_parentKey: (_recordKeyToString4 = recordKeyToString((_options$parentKey = options === null || options === void 0 ? void 0 : options.parentKey) !== null && _options$parentKey !== void 0 ? _options$parentKey : '')) === null || _recordKeyToString4 === void 0 ? void 0 : _recordKeyToString4.toString()\n              }) : editRow,\n              key: recordKey,\n              childrenColumnName: props.childrenColumnName || 'children'\n            };\n            props.setDataSource(editableRowByKey(actionProps, (options === null || options === void 0 ? void 0 : options.position) === 'top' ? 'top' : 'update'));\n            return _context8.abrupt(\"return\", res);\n          case 11:\n          case \"end\":\n            return _context8.stop();\n        }\n      }, _callee8);\n    }));\n    return function (_x7, _x8, _x9, _x10) {\n      return _ref10.apply(this, arguments);\n    };\n  }());\n  var actionDeleteRef = useRefFunction( /*#__PURE__*/function () {\n    var _ref12 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee9(recordKey, editRow) {\n      var _props$onDelete;\n      var actionProps, res;\n      return _regeneratorRuntime().wrap(function _callee9$(_context9) {\n        while (1) switch (_context9.prev = _context9.next) {\n          case 0:\n            actionProps = {\n              data: props.dataSource,\n              getRowKey: props.getRowKey,\n              row: editRow,\n              key: recordKey,\n              childrenColumnName: props.childrenColumnName || 'children'\n            };\n            _context9.next = 3;\n            return props === null || props === void 0 ? void 0 : (_props$onDelete = props.onDelete) === null || _props$onDelete === void 0 ? void 0 : _props$onDelete.call(props, recordKey, editRow);\n          case 3:\n            res = _context9.sent;\n            _context9.next = 6;\n            return cancelEditable(recordKey);\n          case 6:\n            props.setDataSource(editableRowByKey(actionProps, 'delete'));\n            return _context9.abrupt(\"return\", res);\n          case 8:\n          case \"end\":\n            return _context9.stop();\n        }\n      }, _callee9);\n    }));\n    return function (_x11, _x12) {\n      return _ref12.apply(this, arguments);\n    };\n  }());\n  var actionCancelRef = useRefFunction( /*#__PURE__*/function () {\n    var _ref13 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee10(recordKey, editRow, originRow, newLine) {\n      var _props$onCancel;\n      var res;\n      return _regeneratorRuntime().wrap(function _callee10$(_context10) {\n        while (1) switch (_context10.prev = _context10.next) {\n          case 0:\n            _context10.next = 2;\n            return props === null || props === void 0 ? void 0 : (_props$onCancel = props.onCancel) === null || _props$onCancel === void 0 ? void 0 : _props$onCancel.call(props, recordKey, editRow, originRow, newLine);\n          case 2:\n            res = _context10.sent;\n            return _context10.abrupt(\"return\", res);\n          case 4:\n          case \"end\":\n            return _context10.stop();\n        }\n      }, _callee10);\n    }));\n    return function (_x13, _x14, _x15, _x16) {\n      return _ref13.apply(this, arguments);\n    };\n  }());\n  var actionRender = function actionRender(row) {\n    var key = props.getRowKey(row, row.index);\n    var config = {\n      saveText: saveText,\n      cancelText: cancelText,\n      deleteText: deleteText,\n      addEditRecord: addEditRecord,\n      recordKey: key,\n      cancelEditable: cancelEditable,\n      index: row.index,\n      tableName: props.tableName,\n      newLineConfig: newLineRecordCache,\n      onCancel: actionCancelRef,\n      onDelete: actionDeleteRef,\n      onSave: actionSaveRef,\n      editableKeys: editableKeys,\n      setEditableRowKeys: setEditableRowKeys,\n      deletePopconfirmMessage: props.deletePopconfirmMessage || \"\".concat(intl.getMessage('deleteThisLine', '删除此行'), \"?\")\n    };\n    var renderResult = defaultActionRender(row, config);\n    // 缓存一下saveRef\n    if (props.tableName) {\n      saveRefsMap.current.set(dataSourceKeyIndexMapRef.current.get(recordKeyToString(key)) || recordKeyToString(key), renderResult.saveRef);\n    } else {\n      saveRefsMap.current.set(recordKeyToString(key), renderResult.saveRef);\n    }\n    if (props.actionRender) return props.actionRender(row, config, {\n      save: renderResult.save,\n      delete: renderResult.delete,\n      cancel: renderResult.cancel\n    });\n    return [renderResult.save, renderResult.delete, renderResult.cancel];\n  };\n  return {\n    editableKeys: editableKeys,\n    setEditableRowKeys: setEditableRowKeys,\n    isEditable: isEditable,\n    actionRender: actionRender,\n    startEditable: startEditable,\n    cancelEditable: cancelEditable,\n    addEditRecord: addEditRecord,\n    saveEditable: saveEditable,\n    newLineRecord: newLineRecordCache,\n    preEditableKeys: editableKeysRef,\n    onValuesChange: onValuesChange\n  };\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}